/*1338773382,176833974*/

if (window.CavalryLogger) { CavalryLogger.start_js(["Aoa7n"]); }

function Flash(){}copy_properties(Flash,{INIT:'flash/init',READY:'flash/ready',FAILED:'flash/failed'});
__d("ShareInternalConfig",["Bootloader","CSS","ge","DOM"],function(a,b,c,d,e,f){var g=b('Bootloader'),h=b('CSS'),i=b('ge'),j=b('DOM'),k={p:null,t:null};function l(m){if(k.p==m){m+='&c='+encodeURIComponent(k.t?k.t:'');}else k.p=m;var n=i('fbPhotoSnowlift'),o=j.scry(j.getRootElement(),'div.fbAdVideoLightbox'),p=o.length>0?o[0]:null,q=n&&h.shown(n);g.loadModules(['AsyncDialog'],function(r){var s=q?n:p;r.bootstrap('/ajax/sharer/?'+m,s,'dialog');});return false;}e.exports=l;});
__d("legacy:share",["ShareInternalConfig"],function(a,b,c,d){a.share_internal_config=b('ShareInternalConfig');},3);
function motion_spawn_delete_dialog(a,b,c){var d={v:a,delete_dialog:true};if(b)d.parent_oid=b;new AsyncRequest().setURI('/ajax/motion.php').setData(d).setHandler(function(e){var f=e.getPayload();_motion_show_delete_dialog(a,f.preview_content,f.success_content,b,c);}).send();}function _motion_show_delete_dialog(a,b,c,d,e){var f=new Dialog().setTitle(b.title).setBody(b.html).setButtons([Dialog.newButton(b.verb.toLowerCase(),b.verb,'',function(){_motion_delete_video(a,c,d);}),Dialog.CANCEL]).setCausalElement(e).show();}function _motion_delete_video(a,b,c){var d={delete_video:true,v:a};if(c)d.parent_oid=c;new AsyncRequest().setURI('/ajax/motion.php').setData(d).setHandler(function(e){var f=Dialog.getCurrent();if(f)f.hide();if(ge("fbPhotoSnowlift")===null){new Dialog().setTitle(b.title).setBody(b.html).show();goURI.bind(null,b.url).defer(2000);}else goURI(b.url);}).send();}
function motion_show_embed_video_dialog(a,b){var c=new AsyncRequest().setURI('/ajax/video/embed.php').setData({v:a});new Dialog().setClassName('video_embed_dialog').setCausalElement(b).setAsync(c).show();}
function VideoQualityController(a,b,c,d,e){this.video=document[c]||window[c];this.highqual_is_on=d;this.video_is_playing=false;this.is_enabled=true;this.is_permalink=e;VideoQualityController.instance=this;if(this.is_permalink){this.highqual_element=$(a);Event.listen(this.highqual_element,'click',this.toggle_hq.bind(this));this.lowqual_element=$(b);Event.listen(this.lowqual_element,'click',this.toggle_hq.bind(this));if(this.video.tagName.toLowerCase()=='video'){this.player_container=DOM.find(this.video,'^div.uiVideo');this.player_type="html5";}else{this.player_container=this.video.parentNode;this.player_type='flash';}this.video_info=$('video_info');}else this.player_container=Dialog.getCurrent()._popup;}VideoQualityController.getInstance=function(){return VideoQualityController.instance;};VideoQualityController.prototype.toggle_hq=function(){this.highqual_is_on=!this.highqual_is_on;if(this.is_enabled){this.hq_disable();this.video.toggleHQ();}return false;};VideoQualityController.prototype.hq_disable=function(){this.is_enabled=false;};VideoQualityController.prototype.hq_enable=function(a){if(!this.is_enabled)if(this.highqual_is_on!=a){this.video.toggleHQ();return;}this.is_enabled=true;};VideoQualityController.prototype.resize_player=function(a,b){if(this.is_permalink){this.player_container.style.width=a+'px';this.player_container.style.height=b+'px';this.toggle_ui();}else this.player_container.style.width=(parseInt(a)+22)+'px';this.video.style.width=a+'px';this.video.style.height=b+'px';};VideoQualityController.prototype.toggle_ui=function(){CSS.toggle(this.highqual_element);CSS.toggle(this.lowqual_element);CSS.toggleClass(this.video_info,'info_bottom');CSS.toggleClass(this.video_info,'info_right');};
function VideoHistogram(){this.videos={};this.video_payloads={};this.listening=false;this.checking=false;}VideoHistogram.prototype.start=function(a){var b=document[a]||window[a];this.videos[a]=b;this.listening=true;};VideoHistogram.prototype.videoFinished=function(a,b){this.videos[a]=null;this.setPayload(a,b);this.updateServer();if(Dialog){var c=Dialog.getCurrent();if(c){var d=c.getButtonElement('collect-credits');d&&Button.setEnabled(d,true);}}};VideoHistogram.prototype.setPayload=function(a,b){this.video_payloads[a]=b;};VideoHistogram.prototype.updateServer=function(){var a=[];for(var b in this.video_payloads){var c=this.video_payloads[b];this.video_payloads[b]=null;if(c)a.push(c);}var d=JSON.stringify(a);new AsyncSignal('/video/motion_log.php',{h:d}).send();this.listening=false;this.checking=false;};VideoHistogram.prototype.checkStatus=function(){if(this.listening){this.checking=true;for(var a in this.videos)if(this.videos[a].reportTime)this.videos[a].reportTime();this.updateServer();}};copy_properties(VideoHistogram,{init:function(){if(!window.video_histogram)window.video_histogram=new VideoHistogram();onbeforeunloadRegister(function(){if(!window.video_histogram.checking)window.video_histogram.checkStatus();});}});
var VideoPermalinkTagger={show:function(){CSS.removeClass($('tagger'),'tagger_inactive');$('tagger_input').focus();},hide:function(){CSS.addClass($('tagger'),'tagger_inactive');},setDataSource:function(a){VideoPermalinkTagger._datasource=a;},setExcluded:function(a,b){var c=VideoPermalinkTagger._datasource,d=c.getExclusions();a=parseInt(a,10);if(b===false){d.remove(a);}else if(!d.contains(a))d.push(a);c.setExclusions(d);}};function motion_rotate_video(a,b){new AsyncRequest().setURI('/ajax/motion.php').setData({v:a,rotate:b}).setFinallyHandler(function(c){$('rotate_wait').style.display='none';$('rotate_links').style.display='';}).send();$('rotate_links').style.display='none';$('rotate_wait').style.display='';}
function thumb_left_mouseup(a){if(left_disabled)return false;cur_tn--;if(cur_tn==1){left_disabled=true;a.src=tn_left_disabled_src;}if(cur_tn==(tn_arr.length-2)){right_disabled=false;$('right_a').src=tn_right_src;}if(!left_disabled)a.src=tn_left_src;$('tn_summary').innerHTML=cur_tn+' of '+(tn_arr.length-1);$('thumb').value=cur_tn;$('thumb_img').src=tn_arr[cur_tn];return false;}function thumb_left_mousedown(a){if(!left_disabled)a.src=tn_left_active_src;return false;}function thumb_right_mouseup(a){if(right_disabled)return false;cur_tn++;if(cur_tn==(tn_arr.length-1)){right_disabled=true;a.src=tn_right_disabled_src;}if(cur_tn==2){left_disabled=false;$('left_a').src=tn_left_src;}if(!right_disabled)a.src=tn_right_src;$('tn_summary').innerHTML=cur_tn+' of '+(tn_arr.length-1);$('thumb').value=cur_tn;$('thumb_img').src=tn_arr[cur_tn];return false;}function thumb_right_mousedown(a){if(!right_disabled)a.src=tn_right_active_src;return false;}